*
*     Beam parameters common
*
      REAL XBEAM(3),PBEAM(3),SXBEAM(2),SPBEAM,EMIT,SPREAD(5)
      INTEGER QUADMAX
      PARAMETER(QUADMAX=2)
      REAL RPIPE(2),KX(QUADMAX),KY(QUADMAX)
      REAL ZMIN(QUADMAX),ZMAX(QUADMAX)
      COMMON/RBEAM/XBEAM,PBEAM,SXBEAM,SPBEAM,EMIT,SPREAD
     +     ,RPIPE,KX,KY,ZMIN,ZMAX
*
*     Time common
*
      INTEGER ITIME,IGDATE,IGTIME
      REAL TIMINT,TIMEND
      COMMON/GCTIME/TIMINT,TIMEND,ITIME,IGDATE,IGTIME
      Integer IKINE,ITRA,ISTAK,IVERT,IPART,ITRTYP
     +     ,NAPART(5),IPAOLD
      Real    PKINE(10),AMASS,CHARGE,TLIFE,VERT(3),PVERT(4)
      COMMON/GCKINE/IKINE,PKINE,ITRA,ISTAK,IVERT,IPART,ITRTYP
     +     ,NAPART,AMASS,CHARGE,TLIFE,VERT,PVERT,IPAOLD
      
      Integer IDEBUG,IDEMIN,IDEMAX,ITEST,IDRUN,IDEVT,IEORUN
     +     ,IEOTRI,IEVENT,ISWIT(10),IFINIT(20),NEVENT,NRNDM(2)
      COMMON/GCFLAG/IDEBUG,IDEMIN,IDEMAX,ITEST,IDRUN,IDEVT,IEORUN
     +     ,IEOTRI,IEVENT,ISWIT,IFINIT,NEVENT,NRNDM

*
*     GEANT and HBOOK variables
*
      Integer NGBANK, NHBOOK, NFFREA
      Parameter (NGBANK=50000000)
      Parameter (NHBOOK=50000000)
      Parameter (NFFREA=1000)
      Real Q(NGBANK)
      Common /GCBANK/Q
      Real H(NHBOOK)
      Common /PAWC/H
      Real F(NFFREA)    
      Common /CFREAD/F 
*
*     Materials
*
      Integer LIMBO,THEBAR,FORWARD,BACKWARD,CHECKQ1,CHECKQ2
      Parameter (LIMBO=1,THEBAR=3,FORWARD=4,BACKWARD=5)
      Integer R_LEAD,R_ACTIVE,SKIN,SCINT,IPIP
      Parameter (R_LEAD=6,R_ACTIVE=7,SKIN=8,SCINT=21,IPIP=32)
      Parameter (CHECKQ1=33,CHECKQ2=34)
      Integer AIR,LEAD,ALUMINUM,IRON,COPPER,VACUUM,LEAD_SB,PLASTIC,GLUE
      Parameter (AIR=15,LEAD=13,ALUMINUM=9,IRON=10,COPPER=11,VACUUM=16)
      Parameter (LEAD_SB=23,PLASTIC=24,GLUE=25)
*
*     Constants
*
      Real PI,TWOPI,PIBY2,DEGRAD,RADDEG,CLIGHT,BIG,EMASS
      Real EMMU,PMASS,AVO
      Real BOLTZ,JOULEGEV,JOULEKELV
      PARAMETER (PI=3.14159265358979324)
      PARAMETER (TWOPI=6.28318530717958648)
      PARAMETER (PIBY2=1.57079632679489662)
      PARAMETER (DEGRAD=0.0174532925199432958)
      PARAMETER (RADDEG=57.2957795130823209)
      PARAMETER (CLIGHT=29979245800.)
      PARAMETER (BIG=10000000000.)
      PARAMETER (EMASS=0.00051099906)
      PARAMETER (EMMU=0.105658389)
      PARAMETER (PMASS=0.93827231)
      PARAMETER (AVO=0.60221367)
c
      Parameter (JOULEGEV=6.25E+9) ! Joule -> GeV	
      Parameter (BOLTZ=8.617385E-14) ! GeV	
      Parameter (JOULEKELV=JOULEGEV*BOLTZ)
      INTEGER MXGKIN
      PARAMETER (MXGKIN=100)
      INTEGER MXPHOT
      PARAMETER (MXPHOT=800)
      INTEGER       KCASE,NGKINE,IFLGK(MXGKIN),NGPHOT
      REAL          GKIN(5,MXGKIN),TOFD(MXGKIN),XPHOT(11,MXPHOT)
      REAL          GPOS
C
      COMMON/GCKING/KCASE,NGKINE,GKIN,TOFD,IFLGK
      COMMON/GCKIN2/NGPHOT,XPHOT
      COMMON/GCKIN3/GPOS(3,MXGKIN)
      INTEGER MAXMEC,MAXME1
      PARAMETER (MAXMEC=30)
      PARAMETER (MAXME1=30)
*
      INTEGER NMEC,LMEC(MAXMEC),NAMEC(MAXMEC),NSTEP,MAXNST,IGNEXT,INWVOL
     +     ,ISTOP
     +     ,IGAUTO,IEKBIN,ILOSL,IMULL,INGOTO,NLDOWN,NLEVIN,NLVSAV,ISTORY
     +     ,NAMEC1(MAXME1)
      REAL VECT(7),GETOT,GEKIN,VOUT(7),DESTEP,DESTEL,SAFETY,SLENG ,STEP
     +     ,SNEXT,SFIELD,TOFG,GEKRAT,UPWGHT
      REAL POLAR(3)
C
      COMMON/GCTRAK/VECT,GETOT,GEKIN,VOUT,NMEC,LMEC
     +     ,NAMEC,NSTEP ,MAXNST,DESTEP,DESTEL,SAFETY,SLENG
     +     ,STEP ,SNEXT ,SFIELD,TOFG,GEKRAT,UPWGHT,IGNEXT,INWVOL
     +     ,ISTOP ,IGAUTO,IEKBIN,ILOSL,IMULL,INGOTO,NLDOWN,NLEVIN
     +     ,NLVSAV,ISTORY
      COMMON/GCTPOL/POLAR,NAMEC1
      INTEGER       NUMED,NATMED(5),ISVOL,IFIELD,IUPD,ISTPAR,NUMOLD
      REAL          FIELDM,TMAXFD,STEMAX,DEEMAX,EPSIL,STMIN,CFIELD,PREC
      INTEGER       JMIN,NPCKOV,IMCKOV,ITCKOV
      REAL          THRIND,PMIN,DP,DNDL
C      
      COMMON/GCTMED/NUMED,NATMED,ISVOL,IFIELD,FIELDM,TMAXFD,STEMAX
     +     ,DEEMAX,EPSIL,STMIN,CFIELD,PREC,IUPD,ISTPAR,NUMOLD
      COMMON/GCTLIT/THRIND,PMIN,DP,DNDL,JMIN,ITCKOV,IMCKOV,NPCKOV
      INTEGER NLEVEL,NAMES(15),NUMBER(15),LVOLUM(15),LINDEX(15),INFROM
     +     ,NLEVMX
     +     ,NLDEV(15),LINMX(15)
      REAL GTRAN(3,15),GRMAT(10,15),GONLY(15),GLX(3)
C
      COMMON/GCVOLU/NLEVEL,NAMES,NUMBER,
     +LVOLUM,LINDEX,INFROM,NLEVMX,NLDEV,LINMX,
     +GTRAN,GRMAT,GONLY,GLX
      Integer IGEOBAR,CALOGEO,NMODU,NPLANES
      Real   
     +  RBAR,LBAR,WBAR,DDBAR
     +  ,RSCALE(5),ROTA(6),ROTB(6),ROTC(6)
     +	,DISTAC
     +  ,IRONDIM(3),S_PB,S_SCI,S_IRON
      INTEGER HBEA,HBAR,HFRW,HBCK,HCAL,HQUA
*	
      COMMON/RAPGEO/IGEOBAR,CALOGEO,NMODU,NPLANES
     +  ,RBAR,LBAR,WBAR,DDBAR
     +  ,RSCALE,ROTA,ROTB,ROTC
     +	,DISTAC
     +  ,IRONDIM,S_PB,S_SCI,S_IRON,HBEA,HBAR,HFRW,HBCK,HCAL,HQUA
      Integer MAXPART
      Parameter(MAXPART=500)
*     
      Integer IINP,IBCK,IBAR,IQUA1,IQUA2
      Real VBEAM(3),PLBEAM(3),DEBAR(3),DXBAR(3),NPBAR(3),DEDXTOTAL
      Real DEFE(3),DXFE(3),DEPB(3),DXPB(3),DESCI(3),DXSCI(3)
      Real BARFACTOR,DEDXBAR,DEEBAR,DXXBAR,TBAR,DEDX2
      INTEGER NNBAR,NSLICE
      Real DEDXSLICE(100),DSLICE,HSLICE(100),EBAR,TOT1,TOT2
      Common /ROUT0/IINP,IBCK,IBAR,IQUA1,IQUA2
     +  ,VBEAM,PLBEAM,DEBAR,DXBAR
     +	,NPBAR,DEDXTOTAL,DEFE,DXFE,DEPB,DXPB,DESCI,DXSCI
     +  ,BARFACTOR,DEDXBAR,DEEBAR,DXXBAR,TBAR,DEDX2,NNBAR
     +  ,NSLICE,DEDXSLICE,DSLICE,HSLICE,EBAR,TOT1,TOT2
*     
      Integer NINP
      Real XINP(MAXPART),YINP(MAXPART),ZINP(MAXPART)
     +     ,PXINP(MAXPART),PYINP(MAXPART),PZINP(MAXPART)
      Integer PARTINP(MAXPART)
*     
      Integer NBCK
      Real XBCK(MAXPART),YBCK(MAXPART),ZBCK(MAXPART)
     +     ,PXBCK(MAXPART),PYBCK(MAXPART),PZBCK(MAXPART)
      Integer PARTBCK(MAXPART)
*     
      Integer NBAR
      Real XBAR(MAXPART),YBAR(MAXPART),ZBAR(MAXPART)
     +     ,PXBAR(MAXPART),PYBAR(MAXPART),PZBAR(MAXPART),ZET,THE,GFA
      Integer PARTBAR(MAXPART)
*     
      Integer NQUA1
      Real XQUA1(MAXPART),YQUA1(MAXPART),ZQUA1(MAXPART)
     +     ,PXQUA1(MAXPART),PYQUA1(MAXPART),PZQUA1(MAXPART)
      Integer PARTQUA1(MAXPART)
*     
      Integer NQUA2
      Real XQUA2(MAXPART),YQUA2(MAXPART),ZQUA2(MAXPART)
     +     ,PXQUA2(MAXPART),PYQUA2(MAXPART),PZQUA2(MAXPART)
      Integer PARTQUA2(MAXPART)
C     
      Common /RBOX/NINP,XINP,YINP,ZINP,PXINP,PYINP,PZINP,PARTINP
     +     ,NBCK,XBCK,YBCK,ZBCK,PXBCK,PYBCK,PZBCK,PARTBCK
     +     ,NBAR,XBAR,YBAR,ZBAR,PXBAR,PYBAR,PZBAR,ZET,THE,GFA,PARTBAR
     +     ,NQUA1,XQUA1,YQUA1,ZQUA1,PXQUA1,PYQUA1,PZQUA1,PARTQUA1
     +     ,NQUA2,XQUA2,YQUA2,ZQUA2,PXQUA2,PYQUA2,PZQUA2,PARTQUA2

